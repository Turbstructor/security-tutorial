# Virus.Win9x.CIH

- 대만의 천 잉 하오가 만든 바이러스. **체르노빌 바이러스**라고도 하고 **스페이스 필러(Space Filler)**라고도 함.
- 1998년 대만의 천 잉 하오(Chen Ing-Hau)가 만든 바이러스. CIH는 그의 이름의 약자.

## 역사(?)
- 당시 백신 프로그램들의 비싼 가격값을 하지 못하는 바이러스 치유력을 보고 앙심을 품고 이 바이러스를 제작.
- Tatung University의 학생들을 거쳐 바이러스가 퍼져나가기 시작. 이후 1999년 3월엔 출고되는 IBM Aptiva 컴퓨터들에 바이러스가 같이 들어가 있었고, 1999년 12월 31일엔 야마하 CD-R400 드라이브에 대한 소프트웨어 업데이트 파일이 이 바이러스에 감염되어 있었으며, 1998년 7월엔 FPS 게임 SiN의 데모판 버전이 미러 사이트들 중 한 곳을 통해 이 바이러스에 의해 감염됨. 전 세계적으론 추정치 10억 달러의 피해가 있었다고 알려졌다.
- 우리나라에선 1998년 6월에 한 PC 통신 자료실에 올라온 동영상 플레이어 "Movie Player 1.46"을 통해 감염됨. 1999년 4월 26일 CIH 바이러스가 설치된 국내 수많은 컴퓨터들에서 해당 바이러스가 발동하면서 30만대 이상의 컴퓨터가 망가짐.

## 바이러스 특성(바이러스 코드는 [여기](https://github.com/onx/CIH)에서 확인할 수 있다)
- __Windows 9x 기반 OS__(Windows 95, Windows 98, Windows ME)에서 Portable Executable(.exe, .acm, .sys, .efi 등등) 형식 파일들을 통해 전염된다.
- 한번 실행될 경우 메모리에 상주하며 실행 가능한 파일들을 열 때마다 자신을 이들에게 감염시킨다.
- 일반적인 바이러스들은 감염시킬 파일들에 대해 코드를 *자신(바이러스)의 걸로 뒤엎는* 것에 반해, 이 바이러스는 실행 가능 파일들에 대하여 자신의 코드를 쓸 수 있는 빈틈을 찾아 그곳에 자신의 코드를 주입한다. 이러한 특성에서 **Space Filler**라는 별명을 갖게 되었다. (이럴 경우 바이러스에 감염된 파일의 크기에 변화가 없어서 백신에 의한 탐지를 피할 수 있었다고 한다)
- Logic Bomb
    - CIH v1.2(CIH.1003)은 **4월 26일**에 발동. _체르노빌 바이러스라는 별명은 체르노빌 원전 사고일과 같은 날짜에 바이러스가 발동한다는 특성에서 유래함._
    - CIH v1.3(CIH.1010A / CIH.1010B) 바이러스는 **6월 26일**에 발동.
    - CIH v1.4(CIH.1019)는 **매달 26일**에 발동.
    - CIH.1049는 **8월 2일**에 발동.
- 하드 드라이브의 첫 1024KB 내용(섹터 0부터)을 *싹 다 0으로* 바꿔버린다. 여기에 담겨있는 파티션 테이블 정보도 같이 날아가고, 이렇게 BSOD가 발생하거나 컴퓨터가 뻗어버린다.
- 플래시 BIOS를 뒤엎기도 했다(Write-Enable Sequence를 사용했다고 하는데, 컴퓨터 시작시 실행되는 코드 부분을 쓰레기 코드들로 바꿔치는 방법이었다고 한다). 근데 이 방식은 특정 칩셋한테만 먹히는 방법이었다고. ~~(참고 n : 당시 영국에 있는 컴퓨터들 중 75% 정도는 이런 방식의 공격으로부터 면역이었다고 한다.)~~

## 바이러스가 미친 영향
- 전 세계적으로 약 6천만 대의 컴퓨터가 이 바이러스에 감염되었고, 이로 인해 10억 달러 정도의 상업적 손실이 발생했다고 추정.
- 한국과 터키가 각각 30만대로 제일 많은 감염 수를 기록. 그 다음으로는 중국(10만 대), 인도(3만 대), 방글라데시(1만 대). 미국이나 노르웨이는 2000대 정도.
- 국내에선 가정용, 기업용, 관공서용, 군용 등 수많은 컴퓨터들이 감염되고 피해를 입었음.

## 이후 여담
- Tatung University 학생들을 통해 바이러스가 전파된 후, 첸 잉 하오는 학교에 사과하고(???) Tamkang University 학생 웽 시 하오와 공동제작한 안티-CIH 바이러스 백신 프로그램을 배포하였다고 한다. 당시 바이러스를 퍼트린 죄에 관련된 법률이 존재하지 않아 바이러스가 발동한 1999년 4월 26일 이후 얼마 지나지 않아 현지 경찰에 체포되었지만 곧 풀려났다고(이후에 제정됨). 이후 첸 잉 하오는 더 이상 바이러스를 만들지 않겠다고 했다. 웽 시 하오는 이후 와후 인터내셔널 엔터프라이즈라는 미국의 리눅스 관련 기업에 스카웃되어 임베디드 리눅스 프로그래머가 되고, 2005년에 기가바이트에 엔지니어로 입사했다고 한다.
- 체르노빌 바이러스가 터졌던 직후, 백신 프로그램 사용 및 컴퓨터 복구와 관련하여 국내 백신 관련 소프트웨어 업체(하우리, AhnLab 등)들의 주가가 폭등하게 되었다고. 어쩌면 백신 프로그램들이 그렇게 ~~리소스를 잡아먹어가면서까지~~ 백신 업데이트를 매번 하는 게 이런 이유에서가 아닌가 싶다.
    
    - CIH 바이러스가 국내에 처음 들어온 것은 1998년 6월이었다. 이후 이 바이러스와 관련한 상담이 꾸준히 증가세를 보였다. 시중의 불법 소프트웨어가 많이 감염된 것도 바이러스를 급속하게 확산시키는 이유로 작용했고, 심지어 컴퓨터 잡지의 부록으로 나오는 CD롬까지 감염된 경우도 있었다. 시간이 지난 후 바이러스를 퇴치할 수 있는 백신 개발에 성공할 수 있었고, 이후 우리는 지속적인 업데이트가 필요하다는 것을 강조했다. 그러나 당시만 해도 한 번 백신을 깔면 되려니 하는 사람들이 생각보다 많았고 정작 문제가 발생한 1999년 4월까지 상당수 사용자가 업데이트를 하지 않았다. [출처] [안철수, 영혼이 있는 승부] CIH 바이러스 대란|작성자 ahncs0518

- Windows NT 기반 OS들의 경우 파일들에 '빈 공간'이 존재하지 않아 파일들이 CIH 바이러스에 감염되어도 코드가 들어갈 틈이 없어서 별다른 영향이 없었다고 한다.

## 상관없-다고 생각하-는 여담
- 기가바이트엔 Dual BIOS라는 것이 존재하는데, 기존에 쓰고 있는 BIOS가 망가졌을 경우 백업용 BIOS를 메인 BIOS에 덮어씌우는 기능이 있다.

## 참고한 사이트들
- 참고 1. [CIH 바이러스 코드](https://github.com/onx/CIH)
- 참고 2. [위키: CIH 바이러스(영문)](https://en.wikipedia.org/wiki/CIH_(computer_virus))
- 참고 3. [CIH 바이러스가 컴퓨터를 파괴하는 영상](https://www.youtube.com/watch?v=RrnWFAx5vJg)
...
- 참고 (n - 2) : [체르노빌 바이러스란>](http://www.munhwa.com/news/view.html?no=19990426647)
- 참고 (n - 1) : [안철수, 영혼이 있는 승부 / CIH 바이러스 대란](https://blog.naver.com/ahncs0518/221219712289)
- 참고 n : [20년 전 오늘, CIH 바이러스에서 무엇을 배울 수 있는가](https://nakedsecurity.sophos.com/2018/04/26/20-years-ago-today-what-we-can-learn-from-the-cih-virus/)
